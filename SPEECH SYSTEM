#include <SoftwareSerial.h>
#include "VoiceRecognitionV3.h"

SoftwareSerial mySerial(2, 3); // RX, TX
VR myVR(mySerial);

// Declare command indexes
uint8_t records[7]; // Save record
uint8_t buf[64];

#define LED 13 // Output indicator (e.g., LED)

void setup()
{
  Serial.begin(9600);
  mySerial.begin(9600);
  
  pinMode(LED, OUTPUT);

  if (myVR.begin())
    Serial.println("VR Module ready.");
  else {
    Serial.println("VR Module not detected.");
    while (1);
  }

  // Load predefined commands
  if (myVR.load((uint8_t)0, 7) >= 0)
    Serial.println("Commands loaded.");
  else {
    Serial.println("Load command failed.");
    while (1);
  }
}

void loop()
{
  int ret = myVR.recognize(buf, 50);
  if (ret > 0) {
    switch (buf[1]) {
      case 0:
        Serial.println("Command: LED ON");
        digitalWrite(LED, HIGH);
        break;
      case 1:
        Serial.println("Command: LED OFF");
        digitalWrite(LED, LOW);
        break;
      case 2:
        Serial.println("Command: Hello");
        break;
      case 3:
        Serial.println("Command: Good Morning");
        break;
      case 4:
        Serial.println("Command: Play Music");
        break;
      case 5:
        Serial.println("Command: Fan ON");
        break;
      case 6:
        Serial.println("Command: Fan OFF");
        break;
      default:
        Serial.println("Unknown command");
        break;
    }
  }
}
